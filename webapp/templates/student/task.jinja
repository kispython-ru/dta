{% extends 'layout.jinja' %}
{% block header %}
<li class="breadcrumb-item" aria-current="page">
  <a class="text-decoration-none" href="/">
    –¶–ê–ü
  </a>
</li>
<li class="breadcrumb-item">
  <a class="text-decoration-none" href="/group/{{ status.group }}">
    {{ status.group_title }}
  </a>
</li>
<li class="breadcrumb-item active" aria-current="page">
  ‚Ññ{{ status.task + 1 }}, –≤. ‚Ññ{{ status.variant + 1 }}
</li>
{% endblock %}

{% block main %}
<h6 class="card-title fw-bold">
  –ó–∞–¥–∞—á–∞ <span class="badge alert-secondary" style="font-size: inherit">‚Ññ{{ status.task + 1 }}</span>,
  –≤–∞—Ä–∏–∞–Ω—Ç <span class="badge alert-secondary" style="font-size: inherit">‚Ññ{{ status.variant + 1 }}</span>,
  <a href="/group/{{ status.group }}" class="badge alert-primary"
     style="font-size: inherit; text-decoration: none">{{ status.group_title }}</a>
</h6>
{% if status.task != status.external.task or status.variant != status.external.variant or status.group_title != status.external.group_title %}
<h6 class="card-title mt-2">
  ‚ùóÔ∏è –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∏—Ç—å <span class="text-danger fw-bold">—Å–ª—É—á–∞–π–Ω–æ –≤—ã–¥–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</span>, –Ω–æ–º–µ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –í–∞—à–∏–º.
</h6>
{% endif %}
<div class="card-subtitle mb-4 mt-2">
  <a class="text-decoration-none btn btn-primary" target="_blank" href="{{ status.formulation_url }}">
    –ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞—á–µ ‚Ññ{{ status.external.task + 1 }} –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Ññ{{ status.external.variant + 1 }} –≥—Ä—É–ø–ø—ã {{
    status.external.group_title }}
  </a>
</div>
<div>
  <h6 class="card-title fw-bold">
    –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á–∏
  </h6>
  <h6 class="card-subtitle mb-2 text-muted">
    –í –¥–∞–Ω–Ω–æ–π —Å–µ–∫—Ü–∏–∏ –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ—à–µ–Ω–∏—è.
  </h6>
  {% if status.status == 4 %}
  {% else %}
  <div class="badge alert-{{ status.color }} mt-2 mb-2" style="font-size: inherit">
    {{ status.name }}
  </div>
  {% if status.error_message is not none and status.error_message and (not registration or student) %}
  <div>–ü–æ–¥—Ä–æ–±–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ:</div>
  <div class="text-muted mb-2" style="white-space: pre-wrap">{{ status.error_message | e }}</div>
  {% else %}
  <div class="mb-2"></div>
  {% endif %}
  {% endif %}
</div>
{% if status.show_achievements %}
<div>
  <h6 class="card-title fw-bold">
    –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    <small class="text-muted">
      {{ status.earned }} –∏–∑ {{ status.achievements | length }}
    </small>
  </h6>
  <h6 class="card-subtitle mb-2 text-muted">
    –°–º–æ–∂–µ—Ç–µ –ª–∏ –í—ã —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –≤—Å–µ–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ <a class="text-decoration-none"
      href="https://github.com/true-grue/kispython/blob/main/contrib/elm.ipynb">–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏</a>?
  </h6>
  {% if status.achievements %}
  {% for dto in status.achievements %}
  <div class="callout callout-{{ 'success' if dto.active else 'default text-muted' }}">
    <div>{{ dto.title }} {{ '‚úì' if dto.active else '' }}</div>
    <small>{{ dto.description }}</small>
  </div>
  {% endfor %}
  {% endif %}
</div>
{% endif %}
<div class="card m-auto mt-3 mb-5">
  <form class="card-body" action="{{ status.submission_url }}" method="POST">
    <h6 class="card-title fw-bold mb-0">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –æ—Ç–≤–µ—Ç</h6>
    <div class="text-muted mb-2">
      –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ —É—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ–∫–∞–ª—å–Ω–æ.
    </div>
    {% if registration and not student %}
    <div class="row">
      <div class="col-md-8">
        <a class="btn btn-outline-danger w-100 d-block" href="/login">
          –í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
        </a>
      </div>
    </div>
    {% else %}
    <div class="form-group mb-2">
      <textarea id="code-textarea" name="code" type="text" class="form-control" {% if status.disabled or registration
        and not student %}disabled{%endif%} placeholder="–û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ"
        style="min-height: 250px;font-family: monospace, monospace;">{{ form.code.data if form.code.data }}</textarea>
      <small class="form-text text-muted">
        <div>
          –í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç –≤ –ø–æ–ª–µ –≤—ã—à–µ. –í –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–º –∫–æ–¥–µ –Ω–∞ —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è Python –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—è
          <code class="font-weight-bold">main</code> –∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
          –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π —Ç–æ–ª—å–∫–æ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python. <a href="/submissions" class="text-decoration-none">
          –°–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.</a>
        </div>
      </small>
    </div>
    {% if form.code.errors %}
    <ul class="errors">
      {% for error in form.code.errors %}
      <li class="text-danger">{{ error }}</li>
      {% endfor %}
    </ul>
    {% endif %}
    {{ form.csrf_token }}
    <div class="row">
      <div class="col-md-8">
        <button type="submit" class="btn btn-primary w-100 d-block" {% if status.disabled or registration and not
          student %}disabled{%endif%}>
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
        </button>
      </div>
      {% if student and student.teacher %}
      <div class="col-md-4">
        <a class="btn btn-outline-primary w-100 d-block"
           href="/teacher/submissions/group/{{ status.group }}/variant/{{ status.variant }}/task/{{ status.task }}">
          –ò—Å—Ç–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π üìï
        </a>
      </div>
      {% endif %}
    </div>
    {% endif %}
  </form>
</div>

{% if highlight and not (status.disabled or registration and not student) %}
<script src="{{ url_for('static', filename='js/codemirror.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/python.min.js') }}"></script>
<script type="text/javascript">
  CodeMirror.fromTextArea(document.querySelector('#code-textarea'), { mode: 'python', lineNumbers: true, indentUnit: 4 })
</script>
{% endif %}

{% endblock %}
